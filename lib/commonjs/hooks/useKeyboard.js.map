{"version":3,"names":["KEYBOARD_EVENT_MAPPER","KEYBOARD_SHOW","Platform","select","ios","android","default","KEYBOARD_HIDE","useKeyboard","shouldHandleKeyboardEvents","useSharedValue","keyboardState","KEYBOARD_STATE","UNDETERMINED","keyboardHeight","keyboardAnimationEasing","keyboardAnimationDuration","temporaryCachedKeyboardEvent","handleKeyboardEvent","useWorkletCallback","state","height","duration","easing","SHOWN","value","useEffect","handleOnKeyboardShow","event","runOnUI","endCoordinates","handleOnKeyboardHide","HIDDEN","showSubscription","Keyboard","addListener","hideSubscription","remove","useAnimatedReaction","result","params","length","animationEasing","animationDuration"],"sources":["useKeyboard.ts"],"sourcesContent":["import { useEffect } from 'react';\nimport {\n  Keyboard,\n  KeyboardEvent,\n  KeyboardEventEasing,\n  KeyboardEventName,\n  Platform,\n} from 'react-native';\nimport {\n  runOnUI,\n  useAnimatedReaction,\n  useSharedValue,\n  useWorkletCallback,\n} from 'react-native-reanimated';\nimport { KEYBOARD_STATE } from '../constants';\n\nconst KEYBOARD_EVENT_MAPPER = {\n  KEYBOARD_SHOW: Platform.select({\n    ios: 'keyboardWillShow',\n    android: 'keyboardDidShow',\n    default: '',\n  }) as KeyboardEventName,\n  KEYBOARD_HIDE: Platform.select({\n    ios: 'keyboardWillHide',\n    android: 'keyboardDidHide',\n    default: '',\n  }) as KeyboardEventName,\n};\n\nexport const useKeyboard = () => {\n  //#region variables\n  const shouldHandleKeyboardEvents = useSharedValue(false);\n  const keyboardState = useSharedValue<KEYBOARD_STATE>(\n    KEYBOARD_STATE.UNDETERMINED\n  );\n  const keyboardHeight = useSharedValue(0);\n  const keyboardAnimationEasing =\n    useSharedValue<KeyboardEventEasing>('keyboard');\n  const keyboardAnimationDuration = useSharedValue(500);\n  const temporaryCachedKeyboardEvent = useSharedValue<any>([]);\n  //#endregion\n\n  //#region worklets\n  const handleKeyboardEvent = useWorkletCallback(\n    (state, height, duration, easing) => {\n      if (state === KEYBOARD_STATE.SHOWN && !shouldHandleKeyboardEvents.value) {\n        /**\n         * if the keyboard event was fired before the `onFocus` on TextInput,\n         * then we cache the input, and wait till the `shouldHandleKeyboardEvents`\n         * to be updated then fire this function again.\n         */\n        temporaryCachedKeyboardEvent.value = [state, height, duration, easing];\n        return;\n      }\n      keyboardHeight.value =\n        state === KEYBOARD_STATE.SHOWN\n          ? height\n          : height === 0\n          ? keyboardHeight.value\n          : height;\n      keyboardAnimationDuration.value = duration;\n      keyboardAnimationEasing.value = easing;\n      keyboardState.value = state;\n      temporaryCachedKeyboardEvent.value = [];\n    },\n    []\n  );\n  //#endregion\n\n  //#region effects\n  useEffect(() => {\n    const handleOnKeyboardShow = (event: KeyboardEvent) => {\n      runOnUI(handleKeyboardEvent)(\n        KEYBOARD_STATE.SHOWN,\n        event.endCoordinates.height,\n        event.duration,\n        event.easing\n      );\n    };\n    const handleOnKeyboardHide = (event: KeyboardEvent) => {\n      runOnUI(handleKeyboardEvent)(\n        KEYBOARD_STATE.HIDDEN,\n        event.endCoordinates.height,\n        event.duration,\n        event.easing\n      );\n    };\n\n    const showSubscription = Keyboard.addListener(\n      KEYBOARD_EVENT_MAPPER.KEYBOARD_SHOW,\n      handleOnKeyboardShow\n    );\n\n    const hideSubscription = Keyboard.addListener(\n      KEYBOARD_EVENT_MAPPER.KEYBOARD_HIDE,\n      handleOnKeyboardHide\n    );\n\n    return () => {\n      showSubscription.remove();\n      hideSubscription.remove();\n    };\n  }, [handleKeyboardEvent]);\n\n  /**\n   * This reaction is needed to handle the issue with multiline text input.\n   *\n   * @link https://github.com/gorhom/react-native-bottom-sheet/issues/411\n   */\n  useAnimatedReaction(\n    () => shouldHandleKeyboardEvents.value,\n    result => {\n      const params = temporaryCachedKeyboardEvent.value;\n      if (result && params.length > 0) {\n        handleKeyboardEvent(params[0], params[1], params[2], params[3]);\n      }\n    }\n  );\n  //#endregion\n\n  return {\n    state: keyboardState,\n    height: keyboardHeight,\n    animationEasing: keyboardAnimationEasing,\n    animationDuration: keyboardAnimationDuration,\n    shouldHandleKeyboardEvents,\n  };\n};\n"],"mappings":"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"}