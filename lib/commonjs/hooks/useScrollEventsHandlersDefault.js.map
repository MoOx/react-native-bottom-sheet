{"version":3,"names":["useScrollEventsHandlersDefault","scrollableRef","scrollableContentOffsetY","animatedSheetState","animatedScrollableState","animatedAnimationState","animatedScrollableContentOffsetY","rootScrollableContentOffsetY","useBottomSheetInternal","handleOnScroll","useWorkletCallback","_","context","value","SHEET_STATE","EXTENDED","FILL_PARENT","shouldLockInitialPosition","SCROLLABLE_STATE","LOCKED","lockPosition","initialContentOffsetY","scrollTo","handleOnBeginDrag","contentOffset","y","handleOnEndDrag","ANIMATION_STATE","RUNNING","handleOnMomentumEnd"],"sources":["useScrollEventsHandlersDefault.ts"],"sourcesContent":["import { scrollTo, useWorkletCallback } from 'react-native-reanimated';\nimport { useBottomSheetInternal } from './useBottomSheetInternal';\nimport { ANIMATION_STATE, SCROLLABLE_STATE, SHEET_STATE } from '../constants';\nimport type {\n  ScrollEventsHandlersHookType,\n  ScrollEventHandlerCallbackType,\n} from '../types';\n\nexport type ScrollEventContextType = {\n  initialContentOffsetY: number;\n  shouldLockInitialPosition: boolean;\n};\n\nexport const useScrollEventsHandlersDefault: ScrollEventsHandlersHookType = (\n  scrollableRef,\n  scrollableContentOffsetY\n) => {\n  // hooks\n  const {\n    animatedSheetState,\n    animatedScrollableState,\n    animatedAnimationState,\n    animatedScrollableContentOffsetY: rootScrollableContentOffsetY,\n  } = useBottomSheetInternal();\n\n  //#region callbacks\n  const handleOnScroll: ScrollEventHandlerCallbackType<ScrollEventContextType> =\n    useWorkletCallback(\n      (_, context) => {\n        /**\n         * if sheet position is extended or fill parent, then we reset\n         * `shouldLockInitialPosition` value to false.\n         */\n        if (\n          animatedSheetState.value === SHEET_STATE.EXTENDED ||\n          animatedSheetState.value === SHEET_STATE.FILL_PARENT\n        ) {\n          context.shouldLockInitialPosition = false;\n        }\n\n        if (animatedScrollableState.value === SCROLLABLE_STATE.LOCKED) {\n          const lockPosition = context.shouldLockInitialPosition\n            ? context.initialContentOffsetY ?? 0\n            : 0;\n          // @ts-ignore\n          scrollTo(scrollableRef, 0, lockPosition, false);\n          scrollableContentOffsetY.value = lockPosition;\n          return;\n        }\n      },\n      [\n        scrollableRef,\n        scrollableContentOffsetY,\n        animatedScrollableState,\n        animatedSheetState,\n      ]\n    );\n  const handleOnBeginDrag: ScrollEventHandlerCallbackType<ScrollEventContextType> =\n    useWorkletCallback(\n      ({ contentOffset: { y } }, context) => {\n        scrollableContentOffsetY.value = y;\n        rootScrollableContentOffsetY.value = y;\n        context.initialContentOffsetY = y;\n\n        /**\n         * if sheet position not extended or fill parent and the scrollable position\n         * not at the top, then we should lock the initial scrollable position.\n         */\n        if (\n          animatedSheetState.value !== SHEET_STATE.EXTENDED &&\n          animatedSheetState.value !== SHEET_STATE.FILL_PARENT &&\n          y > 0\n        ) {\n          context.shouldLockInitialPosition = true;\n        } else {\n          context.shouldLockInitialPosition = false;\n        }\n      },\n      [\n        scrollableContentOffsetY,\n        animatedSheetState,\n        rootScrollableContentOffsetY,\n      ]\n    );\n  const handleOnEndDrag: ScrollEventHandlerCallbackType<ScrollEventContextType> =\n    useWorkletCallback(\n      ({ contentOffset: { y } }, context) => {\n        if (animatedScrollableState.value === SCROLLABLE_STATE.LOCKED) {\n          const lockPosition = context.shouldLockInitialPosition\n            ? context.initialContentOffsetY ?? 0\n            : 0;\n          // @ts-ignore\n          scrollTo(scrollableRef, 0, lockPosition, false);\n          scrollableContentOffsetY.value = lockPosition;\n          return;\n        }\n        if (animatedAnimationState.value !== ANIMATION_STATE.RUNNING) {\n          scrollableContentOffsetY.value = y;\n          rootScrollableContentOffsetY.value = y;\n        }\n      },\n      [\n        scrollableRef,\n        scrollableContentOffsetY,\n        animatedAnimationState,\n        animatedScrollableState,\n        rootScrollableContentOffsetY,\n      ]\n    );\n  const handleOnMomentumEnd: ScrollEventHandlerCallbackType<ScrollEventContextType> =\n    useWorkletCallback(\n      ({ contentOffset: { y } }, context) => {\n        if (animatedScrollableState.value === SCROLLABLE_STATE.LOCKED) {\n          const lockPosition = context.shouldLockInitialPosition\n            ? context.initialContentOffsetY ?? 0\n            : 0;\n          // @ts-ignore\n          scrollTo(scrollableRef, 0, lockPosition, false);\n          scrollableContentOffsetY.value = 0;\n          return;\n        }\n        if (animatedAnimationState.value !== ANIMATION_STATE.RUNNING) {\n          scrollableContentOffsetY.value = y;\n          rootScrollableContentOffsetY.value = y;\n        }\n      },\n      [\n        scrollableContentOffsetY,\n        scrollableRef,\n        animatedAnimationState,\n        animatedScrollableState,\n        rootScrollableContentOffsetY,\n      ]\n    );\n  //#endregion\n\n  return {\n    handleOnScroll,\n    handleOnBeginDrag,\n    handleOnEndDrag,\n    handleOnMomentumEnd,\n  };\n};\n"],"mappings":"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"}