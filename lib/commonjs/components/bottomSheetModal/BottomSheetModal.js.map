{"version":3,"names":["INITIAL_STATE","mount","data","undefined","BottomSheetModalComponent","forwardRef","BottomSheetModal","props","ref","name","stackBehavior","DEFAULT_STACK_BEHAVIOR","enableDismissOnClose","DEFAULT_ENABLE_DISMISS_ON_CLOSE","onDismiss","_providedOnDismiss","index","snapPoints","enablePanDownToClose","animateOnMount","onChange","_providedOnChange","children","Content","bottomSheetProps","setState","useState","containerHeight","containerOffset","mountSheet","unmountSheet","willUnmountSheet","useBottomSheetModalInternal","removePortal","unmountPortal","usePortal","bottomSheetRef","useRef","currentIndexRef","restoreIndexRef","minimized","forcedDismissed","mounted","current","key","useMemo","id","resetVariables","useCallback","print","component","method","unmount","_mounted","handleSnapToIndex","args","snapToIndex","handleSnapToPosition","snapToPosition","handleExpand","expand","handleCollapse","collapse","handleClose","close","handleForceClose","forceClose","handlePresent","_data","requestAnimationFrame","handleDismiss","animationConfigs","params","handleMinimize","handleRestore","handlePortalOnUnmount","handlePortalRender","render","handleBottomSheetOnChange","_index","handleBottomSheetOnClose","useImperativeHandle","dismiss","present","minimize","restore","memo","displayName"],"sources":["BottomSheetModal.tsx"],"sourcesContent":["import React, {\n  forwardRef,\n  memo,\n  useCallback,\n  useImperativeHandle,\n  useMemo,\n  useRef,\n  useState,\n} from 'react';\nimport { Portal, usePortal } from '@gorhom/portal';\nimport BottomSheet from '../bottomSheet';\nimport { useBottomSheetModalInternal } from '../../hooks';\nimport { print } from '../../utilities';\nimport {\n  DEFAULT_STACK_BEHAVIOR,\n  DEFAULT_ENABLE_DISMISS_ON_CLOSE,\n} from './constants';\nimport type { BottomSheetModalMethods, BottomSheetMethods } from '../../types';\nimport type { BottomSheetModalProps } from './types';\nimport { id } from '../../utilities/id';\n\ntype BottomSheetModal = BottomSheetModalMethods;\n\nconst INITIAL_STATE: {\n  mount: boolean;\n  data: any;\n} = {\n  mount: false,\n  data: undefined,\n};\n\nconst BottomSheetModalComponent = forwardRef<\n  BottomSheetModal,\n  BottomSheetModalProps\n>(function BottomSheetModal(props, ref) {\n  const {\n    // modal props\n    name,\n    stackBehavior = DEFAULT_STACK_BEHAVIOR,\n    enableDismissOnClose = DEFAULT_ENABLE_DISMISS_ON_CLOSE,\n    onDismiss: _providedOnDismiss,\n\n    // bottom sheet props\n    index = 0,\n    snapPoints,\n    enablePanDownToClose = true,\n    animateOnMount = true,\n\n    // callbacks\n    onChange: _providedOnChange,\n\n    // components\n    children: Content,\n    ...bottomSheetProps\n  } = props;\n\n  //#region state\n  const [{ mount, data }, setState] = useState(INITIAL_STATE);\n  //#endregion\n\n  //#region hooks\n  const {\n    containerHeight,\n    containerOffset,\n    mountSheet,\n    unmountSheet,\n    willUnmountSheet,\n  } = useBottomSheetModalInternal();\n  const { removePortal: unmountPortal } = usePortal();\n  //#endregion\n\n  //#region refs\n  const bottomSheetRef = useRef<BottomSheet>(null);\n  const currentIndexRef = useRef(!animateOnMount ? index : -1);\n  const restoreIndexRef = useRef(-1);\n  const minimized = useRef(false);\n  const forcedDismissed = useRef(false);\n  const mounted = useRef(false);\n  mounted.current = mount;\n  //#endregion\n\n  //#region variables\n  const key = useMemo(() => name || `bottom-sheet-modal-${id()}`, [name]);\n  //#endregion\n\n  //#region private methods\n  const resetVariables = useCallback(function resetVariables() {\n    print({\n      component: BottomSheetModal.name,\n      method: resetVariables.name,\n    });\n    currentIndexRef.current = -1;\n    restoreIndexRef.current = -1;\n    minimized.current = false;\n    mounted.current = false;\n    forcedDismissed.current = false;\n  }, []);\n  const unmount = useCallback(\n    function unmount() {\n      print({\n        component: BottomSheetModal.name,\n        method: unmount.name,\n      });\n      const _mounted = mounted.current;\n\n      // reset variables\n      resetVariables();\n\n      // unmount sheet and portal\n      unmountSheet(key);\n      unmountPortal(key);\n\n      // unmount the node, if sheet is still mounted\n      if (_mounted) {\n        setState(INITIAL_STATE);\n      }\n\n      // fire `onDismiss` callback\n      if (_providedOnDismiss) {\n        _providedOnDismiss();\n      }\n    },\n    [key, resetVariables, unmountSheet, unmountPortal, _providedOnDismiss]\n  );\n  //#endregion\n\n  //#region bottom sheet methods\n  const handleSnapToIndex = useCallback<BottomSheetMethods['snapToIndex']>(\n    (...args) => {\n      if (minimized.current) {\n        return;\n      }\n      bottomSheetRef.current?.snapToIndex(...args);\n    },\n    []\n  );\n  const handleSnapToPosition = useCallback<\n    BottomSheetMethods['snapToPosition']\n  >((...args) => {\n    if (minimized.current) {\n      return;\n    }\n    bottomSheetRef.current?.snapToPosition(...args);\n  }, []);\n  const handleExpand = useCallback((...args) => {\n    if (minimized.current) {\n      return;\n    }\n    bottomSheetRef.current?.expand(...args);\n  }, []);\n  const handleCollapse = useCallback((...args) => {\n    if (minimized.current) {\n      return;\n    }\n    bottomSheetRef.current?.collapse(...args);\n  }, []);\n  const handleClose = useCallback((...args) => {\n    if (minimized.current) {\n      return;\n    }\n    bottomSheetRef.current?.close(...args);\n  }, []);\n  const handleForceClose = useCallback((...args) => {\n    if (minimized.current) {\n      return;\n    }\n    bottomSheetRef.current?.forceClose(...args);\n  }, []);\n  //#endregion\n\n  //#region bottom sheet modal methods\n  const handlePresent = useCallback(\n    function handlePresent(_data?: any) {\n      requestAnimationFrame(() => {\n        setState({\n          mount: true,\n          data: _data,\n        });\n        mountSheet(key, ref, stackBehavior);\n\n        print({\n          component: BottomSheetModal.name,\n          method: handlePresent.name,\n        });\n      });\n    },\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    [key, stackBehavior, mountSheet]\n  );\n  const handleDismiss = useCallback<BottomSheetModalMethods['dismiss']>(\n    function handleDismiss(animationConfigs) {\n      print({\n        component: BottomSheetModal.name,\n        method: handleDismiss.name,\n        params: {\n          currentIndexRef: currentIndexRef.current,\n          minimized: minimized.current,\n        },\n      });\n      /**\n       * if modal is already been dismiss, we exit the method.\n       */\n      if (currentIndexRef.current === -1 && minimized.current === false) {\n        return;\n      }\n\n      if (\n        minimized.current ||\n        (currentIndexRef.current === -1 && enablePanDownToClose)\n      ) {\n        unmount();\n        return;\n      }\n      willUnmountSheet(key);\n      forcedDismissed.current = true;\n      bottomSheetRef.current?.forceClose(animationConfigs);\n    },\n    [willUnmountSheet, unmount, key, enablePanDownToClose]\n  );\n  const handleMinimize = useCallback(\n    function handleMinimize() {\n      print({\n        component: BottomSheetModal.name,\n        method: handleMinimize.name,\n        params: {\n          minimized: minimized.current,\n        },\n      });\n      if (minimized.current) {\n        return;\n      }\n      minimized.current = true;\n\n      /**\n       * if modal got minimized before it finish its mounting\n       * animation, we set the `restoreIndexRef` to the\n       * provided index.\n       */\n      if (currentIndexRef.current === -1) {\n        restoreIndexRef.current = index;\n      } else {\n        restoreIndexRef.current = currentIndexRef.current;\n      }\n      bottomSheetRef.current?.close();\n    },\n    [index]\n  );\n  const handleRestore = useCallback(function handleRestore() {\n    print({\n      component: BottomSheetModal.name,\n      method: handleRestore.name,\n      params: {\n        minimized: minimized.current,\n        forcedDismissed: forcedDismissed.current,\n      },\n    });\n    if (!minimized.current || forcedDismissed.current) {\n      return;\n    }\n    minimized.current = false;\n    bottomSheetRef.current?.snapToIndex(restoreIndexRef.current);\n  }, []);\n  //#endregion\n\n  //#region callbacks\n  const handlePortalOnUnmount = useCallback(\n    function handlePortalOnUnmount() {\n      print({\n        component: BottomSheetModal.name,\n        method: handlePortalOnUnmount.name,\n        params: {\n          minimized: minimized.current,\n          forcedDismissed: forcedDismissed.current,\n        },\n      });\n      /**\n       * if modal is already been dismiss, we exit the method.\n       */\n      if (currentIndexRef.current === -1 && minimized.current === false) {\n        return;\n      }\n\n      mounted.current = false;\n      forcedDismissed.current = true;\n\n      if (minimized.current) {\n        unmount();\n        return;\n      }\n      willUnmountSheet(key);\n      bottomSheetRef.current?.close();\n    },\n    [key, unmount, willUnmountSheet]\n  );\n  const handlePortalRender = useCallback(function handlePortalRender(\n    render: () => void\n  ) {\n    if (mounted.current) {\n      render();\n    }\n  },\n  []);\n  const handleBottomSheetOnChange = useCallback(\n    function handleBottomSheetOnChange(_index: number) {\n      print({\n        component: BottomSheetModal.name,\n        method: handleBottomSheetOnChange.name,\n        params: {\n          minimized: minimized.current,\n          forcedDismissed: forcedDismissed.current,\n        },\n      });\n      currentIndexRef.current = _index;\n\n      if (_providedOnChange) {\n        _providedOnChange(_index);\n      }\n    },\n    [_providedOnChange]\n  );\n  const handleBottomSheetOnClose = useCallback(\n    function handleBottomSheetOnClose() {\n      print({\n        component: BottomSheetModal.name,\n        method: handleBottomSheetOnClose.name,\n        params: {\n          minimized: minimized.current,\n          forcedDismissed: forcedDismissed.current,\n        },\n      });\n\n      if (minimized.current) {\n        return;\n      }\n\n      if (enableDismissOnClose) {\n        unmount();\n      }\n    },\n    [enableDismissOnClose, unmount]\n  );\n  //#endregion\n\n  //#region expose methods\n  useImperativeHandle(ref, () => ({\n    // sheet\n    snapToIndex: handleSnapToIndex,\n    snapToPosition: handleSnapToPosition,\n    expand: handleExpand,\n    collapse: handleCollapse,\n    close: handleClose,\n    forceClose: handleForceClose,\n    // modal methods\n    dismiss: handleDismiss,\n    present: handlePresent,\n    // internal\n    minimize: handleMinimize,\n    restore: handleRestore,\n  }));\n  //#endregion\n\n  // render\n  // console.log('BottomSheetModal', index, mount, data);\n  return mount ? (\n    <Portal\n      key={key}\n      name={key}\n      handleOnMount={handlePortalRender}\n      handleOnUpdate={handlePortalRender}\n      handleOnUnmount={handlePortalOnUnmount}\n    >\n      <BottomSheet\n        {...bottomSheetProps}\n        ref={bottomSheetRef}\n        key={key}\n        index={index}\n        snapPoints={snapPoints}\n        enablePanDownToClose={enablePanDownToClose}\n        animateOnMount={animateOnMount}\n        containerHeight={containerHeight}\n        containerOffset={containerOffset}\n        onChange={handleBottomSheetOnChange}\n        onClose={handleBottomSheetOnClose}\n        children={\n          typeof Content === 'function' ? <Content data={data} /> : Content\n        }\n        $modal={true}\n      />\n    </Portal>\n  ) : null;\n});\n\nconst BottomSheetModal = memo(BottomSheetModalComponent);\nBottomSheetModal.displayName = 'BottomSheetModal';\n\nexport default BottomSheetModal;\n"],"mappings":"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"}