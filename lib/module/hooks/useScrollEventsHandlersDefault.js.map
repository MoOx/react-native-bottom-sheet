{"version":3,"names":["scrollTo","useWorkletCallback","useBottomSheetInternal","ANIMATION_STATE","SCROLLABLE_STATE","SHEET_STATE","useScrollEventsHandlersDefault","scrollableRef","scrollableContentOffsetY","animatedSheetState","animatedScrollableState","animatedAnimationState","animatedScrollableContentOffsetY","rootScrollableContentOffsetY","handleOnScroll","_","context","value","EXTENDED","FILL_PARENT","shouldLockInitialPosition","LOCKED","lockPosition","initialContentOffsetY","handleOnBeginDrag","contentOffset","y","handleOnEndDrag","RUNNING","handleOnMomentumEnd"],"sources":["useScrollEventsHandlersDefault.ts"],"sourcesContent":["import { scrollTo, useWorkletCallback } from 'react-native-reanimated';\nimport { useBottomSheetInternal } from './useBottomSheetInternal';\nimport { ANIMATION_STATE, SCROLLABLE_STATE, SHEET_STATE } from '../constants';\nimport type {\n  ScrollEventsHandlersHookType,\n  ScrollEventHandlerCallbackType,\n} from '../types';\n\nexport type ScrollEventContextType = {\n  initialContentOffsetY: number;\n  shouldLockInitialPosition: boolean;\n};\n\nexport const useScrollEventsHandlersDefault: ScrollEventsHandlersHookType = (\n  scrollableRef,\n  scrollableContentOffsetY\n) => {\n  // hooks\n  const {\n    animatedSheetState,\n    animatedScrollableState,\n    animatedAnimationState,\n    animatedScrollableContentOffsetY: rootScrollableContentOffsetY,\n  } = useBottomSheetInternal();\n\n  //#region callbacks\n  const handleOnScroll: ScrollEventHandlerCallbackType<ScrollEventContextType> =\n    useWorkletCallback(\n      (_, context) => {\n        /**\n         * if sheet position is extended or fill parent, then we reset\n         * `shouldLockInitialPosition` value to false.\n         */\n        if (\n          animatedSheetState.value === SHEET_STATE.EXTENDED ||\n          animatedSheetState.value === SHEET_STATE.FILL_PARENT\n        ) {\n          context.shouldLockInitialPosition = false;\n        }\n\n        if (animatedScrollableState.value === SCROLLABLE_STATE.LOCKED) {\n          const lockPosition = context.shouldLockInitialPosition\n            ? context.initialContentOffsetY ?? 0\n            : 0;\n          // @ts-ignore\n          scrollTo(scrollableRef, 0, lockPosition, false);\n          scrollableContentOffsetY.value = lockPosition;\n          return;\n        }\n      },\n      [\n        scrollableRef,\n        scrollableContentOffsetY,\n        animatedScrollableState,\n        animatedSheetState,\n      ]\n    );\n  const handleOnBeginDrag: ScrollEventHandlerCallbackType<ScrollEventContextType> =\n    useWorkletCallback(\n      ({ contentOffset: { y } }, context) => {\n        scrollableContentOffsetY.value = y;\n        rootScrollableContentOffsetY.value = y;\n        context.initialContentOffsetY = y;\n\n        /**\n         * if sheet position not extended or fill parent and the scrollable position\n         * not at the top, then we should lock the initial scrollable position.\n         */\n        if (\n          animatedSheetState.value !== SHEET_STATE.EXTENDED &&\n          animatedSheetState.value !== SHEET_STATE.FILL_PARENT &&\n          y > 0\n        ) {\n          context.shouldLockInitialPosition = true;\n        } else {\n          context.shouldLockInitialPosition = false;\n        }\n      },\n      [\n        scrollableContentOffsetY,\n        animatedSheetState,\n        rootScrollableContentOffsetY,\n      ]\n    );\n  const handleOnEndDrag: ScrollEventHandlerCallbackType<ScrollEventContextType> =\n    useWorkletCallback(\n      ({ contentOffset: { y } }, context) => {\n        if (animatedScrollableState.value === SCROLLABLE_STATE.LOCKED) {\n          const lockPosition = context.shouldLockInitialPosition\n            ? context.initialContentOffsetY ?? 0\n            : 0;\n          // @ts-ignore\n          scrollTo(scrollableRef, 0, lockPosition, false);\n          scrollableContentOffsetY.value = lockPosition;\n          return;\n        }\n        if (animatedAnimationState.value !== ANIMATION_STATE.RUNNING) {\n          scrollableContentOffsetY.value = y;\n          rootScrollableContentOffsetY.value = y;\n        }\n      },\n      [\n        scrollableRef,\n        scrollableContentOffsetY,\n        animatedAnimationState,\n        animatedScrollableState,\n        rootScrollableContentOffsetY,\n      ]\n    );\n  const handleOnMomentumEnd: ScrollEventHandlerCallbackType<ScrollEventContextType> =\n    useWorkletCallback(\n      ({ contentOffset: { y } }, context) => {\n        if (animatedScrollableState.value === SCROLLABLE_STATE.LOCKED) {\n          const lockPosition = context.shouldLockInitialPosition\n            ? context.initialContentOffsetY ?? 0\n            : 0;\n          // @ts-ignore\n          scrollTo(scrollableRef, 0, lockPosition, false);\n          scrollableContentOffsetY.value = 0;\n          return;\n        }\n        if (animatedAnimationState.value !== ANIMATION_STATE.RUNNING) {\n          scrollableContentOffsetY.value = y;\n          rootScrollableContentOffsetY.value = y;\n        }\n      },\n      [\n        scrollableContentOffsetY,\n        scrollableRef,\n        animatedAnimationState,\n        animatedScrollableState,\n        rootScrollableContentOffsetY,\n      ]\n    );\n  //#endregion\n\n  return {\n    handleOnScroll,\n    handleOnBeginDrag,\n    handleOnEndDrag,\n    handleOnMomentumEnd,\n  };\n};\n"],"mappings":"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"}